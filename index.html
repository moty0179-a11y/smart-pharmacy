<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart–ê–ø—Ç–µ–∫–∞ - –£—Å—Ç—å-–ö–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
            background: linear-gradient(45deg, #3498db, #9b59b6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 15px;
            padding: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            background: #f8f9fa;
            border: none;
            border-radius: 10px;
            margin: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            color: #2c3e50;
            font-size: 14px;
        }

        .tab:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }

        .tab.active {
            background: #3498db;
            color: white;
        }

        .content-section {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #3498db;
        }

        .btn {
            padding: 12px 25px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #27ae60;
        }

        .btn-success:hover {
            background: #219653;
        }

        #map {
            height: 500px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #e9ecef;
        }

        .map-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .map-btn {
            padding: 8px 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .pharmacy-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .pharmacy-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .pharmacy-card.delivery {
            border-left-color: #27ae60;
        }

        .delivery-badge {
            background: #27ae60;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-left: 10px;
        }

        .medicine-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .medicine-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid #e9ecef;
        }

        .medicine-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .category-filter {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .category-btn {
            padding: 8px 16px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .category-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .delivery-form {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #2c3e50;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            font-size: 14px;
        }

        .delivery-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .delivery-option {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .delivery-option.selected {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .delivery-time {
            font-size: 1.2em;
            font-weight: bold;
            color: #27ae60;
            margin: 10px 0;
        }

        .reminder-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .assistant-message {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #2196f3;
        }

        .user-message {
            background: #f3e5f5;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #9c27b0;
            text-align: right;
        }

        .chat-container {
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }
            
            .tab {
                margin: 2px 0;
            }
            
            .search-box {
                flex-direction: column;
            }
            
            #map {
                height: 300px;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üíä Smart–ê–ø—Ç–µ–∫–∞</h1>
            <p>–£–º–Ω—ã–π –ø–æ–∏—Å–∫ –ª–µ–∫–∞—Ä—Å—Ç–≤, –¥–æ—Å—Ç–∞–≤–∫–∞ –∏ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –≤ –£—Å—Ç—å-–ö–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫–µ</p>
        </div>

        <div class="nav-tabs">
            <button class="tab active" onclick="showSection('search')">üîç –ü–æ–∏—Å–∫</button>
            <button class="tab" onclick="showSection('map-section')">üó∫Ô∏è –ö–∞—Ä—Ç–∞ –∞–ø—Ç–µ–∫</button>
            <button class="tab" onclick="showSection('delivery')">üöö –î–æ—Å—Ç–∞–≤–∫–∞</button>
            <button class="tab" onclick="showSection('assistant')">ü§ñ –ü–æ–º–æ—â–Ω–∏–∫</button>
            <button class="tab" onclick="showSection('reminders')">‚è∞ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</button>
        </div>

        <!-- –ü–æ–∏—Å–∫ –ª–µ–∫–∞—Ä—Å—Ç–≤ -->
        <div id="search" class="content-section active">
            <h2>üîç –ü–æ–∏—Å–∫ –ª–µ–∫–∞—Ä—Å—Ç–≤</h2>
            <div class="search-box">
                <input type="text" id="medicineSearch" class="search-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞..." onkeypress="handleSearchKeyPress(event)">
                <button class="btn" onclick="searchMedicine()">–ù–∞–π—Ç–∏</button>
            </div>
            
            <div class="category-filter" id="categoryFilter">
                <button class="category-btn active" onclick="filterByCategory('all')">–í—Å–µ</button>
                <button class="category-btn" onclick="filterByCategory('–û–±–µ–∑–±–æ–ª–∏–≤–∞—é—â–∏–µ')">–û–±–µ–∑–±–æ–ª–∏–≤–∞—é—â–∏–µ</button>
                <button class="category-btn" onclick="filterByCategory('–ê–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–∏')">–ê–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–∏</button>
                <button class="category-btn" onclick="filterByCategory('–°–µ—Ä–¥–µ—á–Ω—ã–µ')">–°–µ—Ä–¥–µ—á–Ω—ã–µ</button>
                <button class="category-btn" onclick="filterByCategory('–ñ–µ–ª—É–¥–æ—á–Ω–æ-–∫–∏—à–µ—á–Ω—ã–µ')">–ñ–µ–ª—É–¥–æ—á–Ω—ã–µ</button>
                <button class="category-btn" onclick="filterByCategory('–í–∏—Ç–∞–º–∏–Ω—ã')">–í–∏—Ç–∞–º–∏–Ω—ã</button>
            </div>
            
            <div id="searchResults" class="medicine-grid"></div>
        </div>

        <!-- –ö–∞—Ä—Ç–∞ –∞–ø—Ç–µ–∫ -->
        <div id="map-section" class="content-section">
            <h2>üó∫Ô∏è –ö–∞—Ä—Ç–∞ –∞–ø—Ç–µ–∫ –£—Å—Ç—å-–ö–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫–∞</h2>
            <div class="map-controls">
                <button class="map-btn" onclick="showAllPharmacies()">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∞–ø—Ç–µ–∫–∏</button>
                <button class="map-btn" onclick="showDeliveryPharmacies()">–¢–æ–ª—å–∫–æ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π</button>
                <button class="map-btn" onclick="findNearestPharmacy()">–ë–ª–∏–∂–∞–π—à–∞—è –∫ –º–Ω–µ</button>
            </div>
            <div id="map"></div>
            <div id="pharmacyList" class="pharmacy-list"></div>
        </div>

        <!-- –î–æ—Å—Ç–∞–≤–∫–∞ -->
        <div id="delivery" class="content-section">
            <h2>üöö –î–æ—Å—Ç–∞–≤–∫–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤</h2>
            <p>–ó–∞–∫–∞–∂–∏—Ç–µ –¥–æ—Å—Ç–∞–≤–∫—É –ª–µ–∫–∞—Ä—Å—Ç–≤ –Ω–∞ –¥–æ–º –∏–∑ –±–ª–∏–∂–∞–π—à–∏—Ö –∞–ø—Ç–µ–∫</p>
            
            <div class="delivery-options">
                <div class="delivery-option" onclick="selectDeliveryOption('express')">
                    <h3>üöÄ –≠–∫—Å–ø—Ä–µ—Å—Å-–¥–æ—Å—Ç–∞–≤–∫–∞</h3>
                    <div class="delivery-time">20-40 –º–∏–Ω—É—Ç</div>
                    <p><strong>700 ‚Ç∏</strong></p>
                    <small>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å</small>
                </div>
                <div class="delivery-option" onclick="selectDeliveryOption('standard')">
                    <h3>üì¶ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è</h3>
                    <div class="delivery-time">1-2 —á–∞—Å–∞</div>
                    <p><strong>400 ‚Ç∏</strong></p>
                    <small>–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä</small>
                </div>
                <div class="delivery-option" onclick="selectDeliveryOption('free')">
                    <h3>üéÅ –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è</h3>
                    <div class="delivery-time">2-3 —á–∞—Å–∞</div>
                    <p><strong>0 ‚Ç∏</strong></p>
                    <small>–ü—Ä–∏ –∑–∞–∫–∞–∑–µ –æ—Ç 5000 ‚Ç∏</small>
                </div>
            </div>

            <div class="delivery-form">
                <h3>üìã –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h3>
                <div class="form-group">
                    <label>–í—ã–±–µ—Ä–∏—Ç–µ –∞–ø—Ç–µ–∫—É:</label>
                    <select id="deliveryPharmacy" class="form-control">
                        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∞–ø—Ç–µ–∫—É --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏:</label>
                    <input type="text" id="deliveryAddress" class="form-control" placeholder="—É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, 123">
                </div>
                <div class="form-group">
                    <label>–¢–µ–ª–µ—Ñ–æ–Ω:</label>
                    <input type="tel" id="deliveryPhone" class="form-control" placeholder="+7 (777) 123-45-67">
                </div>
                <div class="form-group">
                    <label>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:</label>
                    <select id="paymentMethod" class="form-control">
                        <option value="cash">–ù–∞–ª–∏—á–Ω—ã–µ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</option>
                        <option value="card">–ö–∞—Ä—Ç–æ–π –æ–Ω–ª–∞–π–Ω</option>
                    </select>
                </div>
                <button class="btn btn-success" onclick="placeDeliveryOrder()">üõí –û—Ñ–æ—Ä–º–∏—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É</button>
            </div>
        </div>

        <!-- –£–º–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ -->
        <div id="assistant" class="content-section">
            <h2>ü§ñ –ê–ø—Ç–µ—á–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫</h2>
            <div class="chat-container" id="chatContainer">
                <div class="assistant-message">
                    <strong>–ü–æ–º–æ—â–Ω–∏–∫:</strong> –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø –≤–∞—à —É–º–Ω—ã–π –∞–ø—Ç–µ—á–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫. –°–ø—Ä–æ—Å–∏—Ç–µ –º–µ–Ω—è –æ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞—Ö, –¥–æ–∑–∏—Ä–æ–≤–∫–∞—Ö, –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è—Ö –∏–ª–∏ —Å–ø–æ—Å–æ–±–∞—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è.
                </div>
            </div>
            <div class="search-box">
                <input type="text" id="userQuestion" class="search-input" placeholder="–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ –ª–µ–∫–∞—Ä—Å—Ç–≤–µ..." onkeypress="handleKeyPress(event)">
                <button class="btn" onclick="askAssistant()">–°–ø—Ä–æ—Å–∏—Ç—å</button>
            </div>
        </div>

        <!-- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è -->
        <div id="reminders" class="content-section">
            <h2>‚è∞ –ú–æ–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</h2>
            <div class="form-group">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞:</label>
                <input type="text" id="reminderMedicine" class="form-control" placeholder="–ü–∞—Ä–∞—Ü–µ—Ç–∞–º–æ–ª">
            </div>
            <div class="form-group">
                <label>–î–æ–∑–∏—Ä–æ–≤–∫–∞:</label>
                <input type="text" id="reminderDosage" class="form-control" placeholder="1 —Ç–∞–±–ª–µ—Ç–∫–∞">
            </div>
            <div class="form-group">
                <label>–ß–∞—Å—Ç–æ—Ç–∞ –ø—Ä–∏–µ–º–∞:</label>
                <select id="reminderFrequency" class="form-control">
                    <option value="3 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å">3 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å</option>
                    <option value="2 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å">2 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å</option>
                    <option value="1 —Ä–∞–∑ –≤ –¥–µ–Ω—å">1 —Ä–∞–∑ –≤ –¥–µ–Ω—å</option>
                    <option value="–∫–∞–∂–¥—ã–µ 4 —á–∞—Å–∞">–∫–∞–∂–¥—ã–µ 4 —á–∞—Å–∞</option>
                    <option value="–∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤">–∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤</option>
                </select>
            </div>
            <button class="btn" onclick="addReminder()">–î–æ–±–∞–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ</button>
            <div id="remindersList" style="margin-top: 20px;"></div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ª–µ–∫–∞—Ä—Å—Ç–≤
        const medicines = [
            {id: 1, name: "–ü–∞—Ä–∞—Ü–µ—Ç–∞–º–æ–ª", price: 150, pharmacyIds: [1,2,3,4,5,6,7,8], category: "–û–±–µ–∑–±–æ–ª–∏–≤–∞—é—â–∏–µ"},
            {id: 2, name: "–ò–±—É–ø—Ä–æ—Ñ–µ–Ω", price: 220, pharmacyIds: [1,3,5,7], category: "–û–±–µ–∑–±–æ–ª–∏–≤–∞—é—â–∏–µ"},
            {id: 3, name: "–ê—Å–ø–∏—Ä–∏–Ω", price: 180, pharmacyIds: [2,4,6,8], category: "–û–±–µ–∑–±–æ–ª–∏–≤–∞—é—â–∏–µ"},
            {id: 4, name: "–ê–Ω–∞–ª—å–≥–∏–Ω", price: 120, pharmacyIds: [1,2,3,4], category: "–û–±–µ–∑–±–æ–ª–∏–≤–∞—é—â–∏–µ"},
            {id: 5, name: "–ö–µ—Ç–∞–Ω–æ–≤", price: 450, pharmacyIds: [3,5,7], category: "–û–±–µ–∑–±–æ–ª–∏–≤–∞—é—â–∏–µ"},
            {id: 6, name: "–ù–∏–º–µ—Å–∏–ª", price: 380, pharmacyIds: [2,4,6,8], category: "–û–±–µ–∑–±–æ–ª–∏–≤–∞—é—â–∏–µ"},
            {id: 7, name: "–ê–º–æ–∫—Å–∏—Ü–∏–ª–ª–∏–Ω", price: 450, pharmacyIds: [2,4,6,8], category: "–ê–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–∏"},
            {id: 8, name: "–ê–∑–∏—Ç—Ä–æ–º–∏—Ü–∏–Ω", price: 520, pharmacyIds: [1,3,5,7], category: "–ê–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–∏"},
            {id: 9, name: "–í–∞–ª–∏–¥–æ–ª", price: 90, pharmacyIds: [1,3,5,7], category: "–°–µ—Ä–¥–µ—á–Ω—ã–µ"},
            {id: 10, name: "–ö–æ—Ä–≤–∞–ª–æ–ª", price: 110, pharmacyIds: [2,4,6,8], category: "–°–µ—Ä–¥–µ—á–Ω—ã–µ"},
            {id: 11, name: "–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —É–≥–æ–ª—å", price: 50, pharmacyIds: [1,2,3,4,5,6,7,8], category: "–ñ–µ–ª—É–¥–æ—á–Ω–æ-–∫–∏—à–µ—á–Ω—ã–µ"},
            {id: 12, name: "–°–º–µ–∫—Ç–∞", price: 180, pharmacyIds: [1,3,5,7], category: "–ñ–µ–ª—É–¥–æ—á–Ω–æ-–∫–∏—à–µ—á–Ω—ã–µ"},
            {id: 13, name: "–í–∏—Ç–∞–º–∏–Ω C", price: 120, pharmacyIds: [1,2,3,4,5,6,7,8], category: "–í–∏—Ç–∞–º–∏–Ω—ã"},
            {id: 14, name: "–í–∏—Ç—Ä—É–º", price: 2800, pharmacyIds: [2,4,6,8], category: "–í–∏—Ç–∞–º–∏–Ω—ã"},
        ];

        // –î–∞–Ω–Ω—ã–µ –∞–ø—Ç–µ–∫ –£—Å—Ç—å-–ö–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–æ–π
        const pharmacies = [
            {id: 1, name: "–ê–ø—Ç–µ–∫–∞ ‚Ññ1", address: "—É–ª. –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è, 45", lat: 49.9485, lng: 82.6289, phone: "+7 (7232) 26-15-47", hours: "09:00-21:00", rating: 4.5, delivery: true, deliveryTime: "20-40 –º–∏–Ω", deliveryPrice: 700},
            {id: 2, name: "–ì–æ—Ä–æ–¥—Å–∫–∞—è –∞–ø—Ç–µ–∫–∞", address: "–ø—Ä. –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, 23", lat: 49.9532, lng: 82.6341, phone: "+7 (7232) 25-38-29", hours: "08:00-22:00", rating: 4.7, delivery: true, deliveryTime: "1-2 —á–∞—Å–∞", deliveryPrice: 400},
            {id: 3, name: "–ï–≤—Ä–æ—Ñ–∞—Ä–º", address: "—É–ª. –ö–∏—Ä–æ–≤–∞, 78", lat: 49.9418, lng: 82.6193, phone: "+7 (7232) 27-84-56", hours: "08:30-20:30", rating: 4.3, delivery: false},
            {id: 4, name: "–ê–ø—Ç–µ–∫–∞ –ó–¥–æ—Ä–æ–≤—å—è", address: "—É–ª. –ü—Ä–æ—Ç–æ–∑–∞–Ω–æ–≤–∞, 12", lat: 49.9587, lng: 82.6423, phone: "+7 (7232) 24-67-89", hours: "09:00-20:00", rating: 4.6, delivery: true, deliveryTime: "25-45 –º–∏–Ω", deliveryPrice: 650},
            {id: 5, name: "–ú–µ–¥—Å–µ—Ä–≤–∏—Å", address: "—É–ª. –£—à–∞–Ω–æ–≤–∞, 34", lat: 49.9456, lng: 82.6312, phone: "+7 (7232) 23-45-67", hours: "08:00-21:00", rating: 4.4, delivery: true, deliveryTime: "1-2 —á–∞—Å–∞", deliveryPrice: 400},
            {id: 6, name: "–§–∞—Ä–º–∞—Ü–∏—è", address: "–ø—Ä. –ê–±–∞—è, 56", lat: 49.9501, lng: 82.6254, phone: "+7 (7232) 28-90-12", hours: "09:00-19:00", rating: 4.2, delivery: false},
            {id: 7, name: "–ê–ø—Ç–µ–∫–∞ 24/7", address: "—É–ª. –ú. –ì–æ—Ä—å–∫–æ–≥–æ, 89", lat: 49.9472, lng: 82.6389, phone: "+7 (7232) 29-34-56", hours: "–∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ", rating: 4.8, delivery: true, deliveryTime: "15-30 –º–∏–Ω", deliveryPrice: 800},
            {id: 8, name: "–ë–∏–æ—Ñ–∞—Ä–º", address: "—É–ª. –ö. –õ–∏–±–∫–Ω–µ—Ö—Ç–∞, 67", lat: 49.9528, lng: 82.6217, phone: "+7 (7232) 22-78-90", hours: "08:00-20:00", rating: 4.1, delivery: false}
        ];

        let map;
        let markers = [];
        let currentCategory = 'all';
        let reminders = JSON.parse(localStorage.getItem('reminders')) || [];
        let selectedDeliveryOption = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
        function initMap() {
            map = L.map('map').setView([49.9485, 82.6289], 13);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors',
                maxZoom: 18
            }).addTo(map);

            updatePharmacyMarkers();
            updatePharmacyList();
            updateDeliveryPharmacyList();
        }

        function updatePharmacyMarkers(filterDelivery = false) {
            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –º–∞—Ä–∫–µ—Ä—ã
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];

            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –º–∞—Ä–∫–µ—Ä—ã
            pharmacies.forEach(pharmacy => {
                if (filterDelivery && !pharmacy.delivery) return;

                const iconColor = pharmacy.delivery ? 'green' : 'blue';
                const icon = L.divIcon({
                    className: 'custom-icon',
                    html: `<div style="background-color: ${iconColor}; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);"></div>`,
                    iconSize: [20, 20],
                    iconAnchor: [10, 10]
                });

                const marker = L.marker([pharmacy.lat, pharmacy.lng], {icon: icon})
                    .addTo(map)
                    .bindPopup(`
                        <div style="min-width: 200px">
                            <b>${pharmacy.name}</b>
                            ${pharmacy.delivery ? '<span style="color: green; margin-left: 10px;">üöö –î–æ—Å—Ç–∞–≤–∫–∞</span>' : ''}
                            <br>üìç ${pharmacy.address}<br>
                            üìû ${pharmacy.phone}<br>
                            ‚è∞ ${pharmacy.hours}<br>
                            ‚≠ê ${pharmacy.rating}
                            ${pharmacy.delivery ? `<br>üöö ${pharmacy.deliveryTime} ‚Ä¢ ${pharmacy.deliveryPrice} ‚Ç∏` : ''}
                        </div>
                    `);
                
                markers.push(marker);
            });
        }

        function updatePharmacyList() {
            const list = document.getElementById('pharmacyList');
            list.innerHTML = pharmacies.map(pharmacy => `
                <div class="pharmacy-card ${pharmacy.delivery ? 'delivery' : ''}">
                    <h3>${pharmacy.name} ${pharmacy.delivery ? '<span class="delivery-badge">üöö –î–æ—Å—Ç–∞–≤–∫–∞</span>' : ''}</h3>
                    <p>üìç ${pharmacy.address}</p>
                    <p>üìû ${pharmacy.phone}</p>
                    <p>‚è∞ ${pharmacy.hours}</p>
                    <p>‚≠ê ${pharmacy.rating}</p>
                    ${pharmacy.delivery ? `<p>üöö ${pharmacy.deliveryTime} ‚Ä¢ ${pharmacy.deliveryPrice} ‚Ç∏</p>` : ''}
                    <button class="btn" onclick="showOnMap(${pharmacy.lat}, ${pharmacy.lng})" style="margin-top: 10px; padding: 8px 15px; font-size: 14px;">–ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ</button>
                </div>
            `).join('');
        }

        function updateDeliveryPharmacyList() {
            const select = document.getElementById('deliveryPharmacy');
            select.innerHTML = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∞–ø—Ç–µ–∫—É --</option>';
            
            pharmacies.filter(p => p.delivery).forEach(pharmacy => {
                const option = document.createElement('option');
                option.value = pharmacy.id;
                option.textContent = `${pharmacy.name} - ${pharmacy.deliveryTime} ‚Ä¢ ${pharmacy.deliveryPrice} ‚Ç∏`;
                select.appendChild(option);
            });
        }

        function showOnMap(lat, lng) {
            map.setView([lat, lng], 16);
            showSection('map-section');
        }

        function showAllPharmacies() {
            updatePharmacyMarkers(false);
            updatePharmacyList();
        }

        function showDeliveryPharmacies() {
            updatePharmacyMarkers(true);
            const deliveryPharmacies = pharmacies.filter(p => p.delivery);
            const list = document.getElementById('pharmacyList');
            list.innerHTML = deliveryPharmacies.map(pharmacy => `
                <div class="pharmacy-card delivery">
                    <h3>${pharmacy.name} <span class="delivery-badge">üöö –î–æ—Å—Ç–∞–≤–∫–∞</span></h3>
                    <p>üìç ${pharmacy.address}</p>
                    <p>üìû ${pharmacy.phone}</p>
                    <p>‚è∞ ${pharmacy.hours}</p>
                    <p>‚≠ê ${pharmacy.rating}</p>
                    <p>üöö ${pharmacy.deliveryTime} ‚Ä¢ ${pharmacy.deliveryPrice} ‚Ç∏</p>
                    <button class="btn" onclick="showOnMap(${pharmacy.lat}, ${pharmacy.lng})" style="margin-top: 10px; padding: 8px 15px; font-size: 14px;">–ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ</button>
                </div>
            `).join('');
        }

        function findNearestPharmacy() {
            // –ü—Ä–æ—Å—Ç–∞—è –∏–º–∏—Ç–∞—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è - —Ü–µ–Ω—Ç—Ä –≥–æ—Ä–æ–¥–∞
            const userLat = 49.9485;
            const userLng = 82.6289;
            
            let nearestPharmacy = null;
            let minDistance = Infinity;

            pharmacies.forEach(pharmacy => {
                const distance = Math.sqrt(
                    Math.pow(pharmacy.lat - userLat, 2) + 
                    Math.pow(pharmacy.lng - userLng, 2)
                );
                
                if (distance < minDistance) {
                    minDistance = distance;
                    nearestPharmacy = pharmacy;
                }
            });

            if (nearestPharmacy) {
                map.setView([nearestPharmacy.lat, nearestPharmacy.lng], 15);
                alert(`–ë–ª–∏–∂–∞–π—à–∞—è –∞–ø—Ç–µ–∫–∞: ${nearestPharmacy.name}\n–ê–¥—Ä–µ—Å: ${nearestPharmacy.address}`);
            }
        }

        function selectDeliveryOption(option) {
            selectedDeliveryOption = option;
            document.querySelectorAll('.delivery-option').forEach(el => {
                el.classList.remove('selected');
            });
            event.target.closest('.delivery-option').classList.add('selected');
        }

        function placeDeliveryOrder() {
            const pharmacyId = document.getElementById('deliveryPharmacy').value;
            const address = document.getElementById('deliveryAddress').value;
            const phone = document.getElementById('deliveryPhone').value;

            if (!pharmacyId || !address || !phone || !selectedDeliveryOption) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏');
                return;
            }

            const pharmacy = pharmacies.find(p => p.id == pharmacyId);
            const deliveryInfo = getDeliveryInfo(selectedDeliveryOption);
            
            alert(`‚úÖ –ó–∞–∫–∞–∑ –Ω–∞ –¥–æ—Å—Ç–∞–≤–∫—É –æ—Ñ–æ—Ä–º–ª–µ–Ω!\n\n–ê–ø—Ç–µ–∫–∞: ${pharmacy.name}\n–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏: ${address}\n–¢–µ–ª–µ—Ñ–æ–Ω: ${phone}\n–¢–∏–ø –¥–æ—Å—Ç–∞–≤–∫–∏: ${deliveryInfo.name}\n–í—Ä–µ–º—è: ${deliveryInfo.time}\n–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏: ${deliveryInfo.price} ‚Ç∏\n\n–° –≤–∞–º–∏ —Å–≤—è–∂—É—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞.`);
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('deliveryAddress').value = '';
            document.getElementById('deliveryPhone').value = '';
            document.querySelectorAll('.delivery-option').forEach(el => {
                el.classList.remove('selected');
            });
            selectedDeliveryOption = null;
        }

        function getDeliveryInfo(option) {
            const deliveryOptions = {
                'express': { name: '–≠–∫—Å–ø—Ä–µ—Å—Å-–¥–æ—Å—Ç–∞–≤–∫–∞', time: '20-40 –º–∏–Ω—É—Ç', price: 700 },
                'standard': { name: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞', time: '1-2 —á–∞—Å–∞', price: 400 },
                'free': { name: '–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞', time: '2-3 —á–∞—Å–∞', price: 0 }
            };
            return deliveryOptions[option] || deliveryOptions.standard;
        }

        // –§—É–Ω–∫—Ü–∏–∏ –ø–æ–∏—Å–∫–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤
        function searchMedicine() {
            const query = document.getElementById('medicineSearch').value.toLowerCase().trim();
            let results = medicines;

            if (query) {
                results = results.filter(med => med.name.toLowerCase().includes(query));
            }

            if (currentCategory !== 'all') {
                results = results.filter(med => med.category === currentCategory);
            }

            displaySearchResults(results);
        }

        function displaySearchResults(results) {
            const resultsContainer = document.getElementById('searchResults');
            
            if (results.length === 0) {
                resultsContainer.innerHTML = '<p style="grid-column: 1/-1; text-align: center; padding: 20px; color: #666;">–õ–µ–∫–∞—Ä—Å—Ç–≤–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –∑–∞–ø—Ä–æ—Å.</p>';
                return;
            }

            resultsContainer.innerHTML = results.map(med => `
                <div class="medicine-card" onclick="showMedicineInfo('${med.name}')">
                    <h4>${med.name}</h4>
                    <p style="color: #666; font-size: 14px;">${med.category}</p>
                    <p style="font-weight: bold; color: #2c3e50; margin: 10px 0;">${med.price} ‚Ç∏</p>
                    <small style="color: #27ae60;">–ï—Å—Ç—å –≤ ${med.pharmacyIds.length} –∞–ø—Ç–µ–∫–∞—Ö</small>
                </div>
            `).join('');
        }

        function filterByCategory(category) {
            currentCategory = category;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            searchMedicine();
        }

        function showMedicineInfo(medicineName) {
            const medicine = medicines.find(m => m.name === medicineName);
            if (medicine) {
                const availablePharmacies = pharmacies.filter(p => medicine.pharmacyIds.includes(p.id));
                const pharmacyNames = availablePharmacies.map(p => p.name).join(', ');
                
                alert(`
üíä ${medicineName}

üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${medicine.category}
üí∞ –¶–µ–Ω–∞: ${medicine.price} ‚Ç∏
üè™ –î–æ—Å—Ç—É–ø–Ω–æ –≤: ${pharmacyNames}

üí° –°–æ–≤–µ—Ç: ${getMedicineAdvice(medicineName)}
                `);
            }
        }

        function getMedicineAdvice(medicineName) {
            const adviceMap = {
                '–ü–∞—Ä–∞—Ü–µ—Ç–∞–º–æ–ª': '–ü—Ä–∏–Ω–∏–º–∞—Ç—å –ø–æ—Å–ª–µ –µ–¥—ã. –ù–µ –ø—Ä–µ–≤—ã—à–∞—Ç—å —Å—É—Ç–æ—á–Ω—É—é –¥–æ–∑—É 4000 –º–≥.',
                '–ò–±—É–ø—Ä–æ—Ñ–µ–Ω': '–ü—Ä–∏–Ω–∏–º–∞—Ç—å –≤–æ –≤—Ä–µ–º—è –µ–¥—ã –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏—è –∂–µ–ª—É–¥–∫–∞.',
                '–ê—Å–ø–∏—Ä–∏–Ω': '–ù–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø—Ä–∏ —è–∑–≤–µ –∂–µ–ª—É–¥–∫–∞. –ü—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω –¥–µ—Ç—è–º –¥–æ 12 –ª–µ—Ç.',
                '–ê–º–æ–∫—Å–∏—Ü–∏–ª–ª–∏–Ω': '–ü—Ä–∏–Ω–∏–º–∞—Ç—å —Å—Ç—Ä–æ–≥–æ –ø–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—é –≤—Ä–∞—á–∞. –ö—É—Ä—Å –ª–µ—á–µ–Ω–∏—è –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—Ç—å.',
                '–í–∞–ª–∏–¥–æ–ª': '–ü—Ä–∏–Ω–∏–º–∞—Ç—å —Å—É–±–ª–∏–Ω–≥–≤–∞–ª—å–Ω–æ (–ø–æ–¥ —è–∑—ã–∫) –ø—Ä–∏ –ø—Ä–∏—Å—Ç—É–ø–∞—Ö —Å—Ç–µ–Ω–æ–∫–∞—Ä–¥–∏–∏.',
                '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —É–≥–æ–ª—å': '–ü—Ä–∏–Ω–∏–º–∞—Ç—å –∏–∑ —Ä–∞—Å—á–µ—Ç–∞ 1 —Ç–∞–±–ª–µ—Ç–∫–∞ –Ω–∞ 10 –∫–≥ –≤–µ—Å–∞.',
                '–í–∏—Ç–∞–º–∏–Ω C': '–õ—É—á—à–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–æ—Å–ª–µ –µ–¥—ã. –ù–µ –ø—Ä–µ–≤—ã—à–∞—Ç—å —Å—É—Ç–æ—á–Ω—É—é –Ω–æ—Ä–º—É.'
            };
            
            return adviceMap[medicineName] || '–ü–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –ø—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ—Å—å —Å –≤—Ä–∞—á–æ–º. –°–æ–±–ª—é–¥–∞–π—Ç–µ –¥–æ–∑–∏—Ä–æ–≤–∫—É –∏ —É—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è.';
        }

        function handleSearchKeyPress(event) {
            if (event.key === 'Enter') {
                searchMedicine();
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –ø–æ–º–æ—â–Ω–∏–∫–∞
        function askAssistant() {
            const question = document.getElementById('userQuestion').value;
            if (!question.trim()) return;

            const chatContainer = document.getElementById('chatContainer');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            chatContainer.innerHTML += `
                <div class="user-message">
                    <strong>–í—ã:</strong> ${question}
                </div>
            `;

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç
            const answer = generateAnswer(question);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
            setTimeout(() => {
                chatContainer.innerHTML += `
                    <div class="assistant-message">
                        <strong>–ü–æ–º–æ—â–Ω–∏–∫:</strong> ${answer}
                    </div>
                `;
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }, 500);

            document.getElementById('userQuestion').value = '';
        }

        function generateAnswer(question) {
            const lowerQuestion = question.toLowerCase();
            
            // –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º –ª–µ–∫–∞—Ä—Å—Ç–≤
            for (const medicine of medicines) {
                if (lowerQuestion.includes(medicine.name.toLowerCase())) {
                    return `
                        ${medicine.name} - —ç—Ç–æ ${medicine.category}. 
                        –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: ${medicine.price} ‚Ç∏. 
                        ${getMedicineAdvice(medicine.name)}
                        –î–æ—Å—Ç—É–ø–µ–Ω –≤ ${medicine.pharmacyIds.length} –∞–ø—Ç–µ–∫–∞—Ö –≥–æ—Ä–æ–¥–∞.
                    `;
                }
            }

            // –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
            if (lowerQuestion.includes('–¥–æ—Å—Ç–∞–≤–∫–∞')) {
                const deliveryPharmacies = pharmacies.filter(p => p.delivery);
                return `–î–æ—Å—Ç–∞–≤–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–∑ ${deliveryPharmacies.length} –∞–ø—Ç–µ–∫. –≠–∫—Å–ø—Ä–µ—Å—Å-–¥–æ—Å—Ç–∞–≤–∫–∞: 20-40 –º–∏–Ω—É—Ç (700 ‚Ç∏), —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è: 1-2 —á–∞—Å–∞ (400 ‚Ç∏), –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –ø—Ä–∏ –∑–∞–∫–∞–∑–µ –æ—Ç 5000 ‚Ç∏. –û—Ñ–æ—Ä–º–∏—Ç–µ –∑–∞–∫–∞–∑ –≤ —Ä–∞–∑–¥–µ–ª–µ "–î–æ—Å—Ç–∞–≤–∫–∞".`;
            }

            if (lowerQuestion.includes('—Ä–∞–±–æ—Ç–∞–µ—Ç') || lowerQuestion.includes('–≤—Ä–µ–º—è')) {
                return "–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ø—Ç–µ–∫ —É–∫–∞–∑–∞–Ω–æ –Ω–∞ –∫–∞—Ä—Ç–µ. –ú–Ω–æ–≥–∏–µ –∞–ø—Ç–µ–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –¥–æ 21-22 —á–∞—Å–æ–≤, –µ—Å—Ç—å –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω—ã–µ.";
            }

            return "–Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞—Ö, –∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏, –¥–æ–∑–∏—Ä–æ–≤–∫–∞—Ö –∏ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è—Ö. –°–ø—Ä–æ—Å–∏—Ç–µ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –ø—Ä–µ–ø–∞—Ä–∞—Ç–µ –∏–ª–∏ —É—Ç–æ—á–Ω–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å.";
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                askAssistant();
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
        function addReminder() {
            const medicine = document.getElementById('reminderMedicine').value;
            const dosage = document.getElementById('reminderDosage').value;
            const frequency = document.getElementById('reminderFrequency').value;

            if (!medicine.trim()) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞');
                return;
            }

            const reminder = {
                id: Date.now(),
                medicine,
                dosage,
                frequency,
                created: new Date().toLocaleString()
            };

            reminders.push(reminder);
            localStorage.setItem('reminders', JSON.stringify(reminders));
            updateRemindersList();
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
            document.getElementById('reminderMedicine').value = '';
            document.getElementById('reminderDosage').value = '';
        }

        function updateRemindersList() {
            const list = document.getElementById('remindersList');
            list.innerHTML = reminders.map(reminder => `
                <div class="reminder-item">
                    <div>
                        <strong>${reminder.medicine}</strong><br>
                        <small>${reminder.dosage} ‚Ä¢ ${reminder.frequency}</small><br>
                        <small>–î–æ–±–∞–≤–ª–µ–Ω–æ: ${reminder.created}</small>
                    </div>
                    <button class="btn" onclick="deleteReminder(${reminder.id})" style="padding: 8px 15px; font-size: 14px;">–£–¥–∞–ª–∏—Ç—å</button>
                </div>
            `).join('');
        }

        function deleteReminder(id) {
            reminders = reminders.filter(r => r.id !== id);
            localStorage.setItem('reminders', JSON.stringify(reminders));
            updateRemindersList();
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–∞–∑–¥–µ–ª–æ–≤
        function showSection(sectionName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });

            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
            document.getElementById(sectionName).classList.add('active');
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –≤–∫–ª–∞–¥–∫—É
            const activeTab = document.querySelector(`.tab[onclick="showSection('${sectionName}')"]`);
            if (activeTab) {
                activeTab.classList.add('active');
            }

            // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –∫–∞—Ä—Ç—É, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –µ—ë
            if (sectionName === 'map-section' && !map) {
                setTimeout(initMap, 100);
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            displaySearchResults(medicines);
            updateRemindersList();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞—Ä—Ç—É —Å—Ä–∞–∑—É
            initMap();
        });
    </script>
</body>
</html>